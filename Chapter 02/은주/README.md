# Chaper 2. 디버깅 기법으로 앱 로직 이해하기
## 2.1. 코드 분석만으로는 불충분한 경우
- 코드는 선형적이지 않고, 일종의 미로 찾기와 같은 행위다
- 새로운 코드 커맨드를 조사할 때마다 새로운 조사 플랜이 수립되며, 인지 복합성은 가중된다
- 새로 오픈하는 플랜이 적을수록 프로세스 복잡도는 감소한다
  - **코드 조사를 할 때는 가급적 오픈한 플랜 수를 줄여 읽기 경로를 단축하라**

## 2.2. 디버거를 이용한 코드 조사
- 디버거를 사용하면 조사 프로세스가 간소화된다.
  - 특정 스텝에서 잠깐 실행을 멈추고, 각 커맨드를 본인 페이스에 맞게 수동 실행 가능하다
  - 코드 읽기 경로 상의 현재 위치, 출처를 표시함으로써 세부 정보를 일일이 다 기억하지 않아도 된다
  - 변수에 어떤 값이 담겼는지 화면에 표시되어 코드 조사가 더 눈에 잘 띄고 쉽게 진행할 수 있다
  - 와처로 즉석에서 원하는 동자을 바로 시험하거나 표현식 평가할 수 있다
- 디버거를 언제 사용해야 할지는 어떻게 알 수 있을까? 
  - 핵심 전제 : **지금 내가 조사하려는 로직이 무엇인가? 를 아는 것**이다
- **디버거로 코드를 조사할 때는 이해할 수 없는 코드의 첫 라인부터 시작하라**
- 실행 스택 트레이스 : 디버거가 실행 중단시킨 라인에서 앱이 이 코드 라인을 어떻게 실행하는지를 나타낸다
  - 이를 조사하면 **특정 커맨드에 어떻게 도달했는지 일일이 기억할 필요 없이 실행 경로를 한눈에 볼 수 있다**

### 2.2.1. 실행 스택 트레이스란 무엇이고 어떻게 사용해야 할까?
- 실행 스택 트레이스 : 실제 지도처럼 디버거가 중단 시킨 코드 라인의 실행 경로
  - 스택 트레이스는 디버거가 실행을 멈춘 지점까지 메소드가 서로 어떻게 호출하는지 나타낸다

### 2.2.2. 디버거로 코드 탐색하기
- `스텝 오버` : 동일한 메소드에서 다음 코드 라인으로 계속 실행
  - 동일한 메소드에서 그다음 커맨드로 넘어가는 일을 한다
  - 동일한 조사 플랜에 머무른다
- `스텝 인투` : 현재 라인에서 호출된 메소드 중 하나의 내부로 들어가 실행을 이어간다
  - 새로운 조사 플랜을 시작해서 어떤 커맨드 안으로 자세히 파고들고 싶을 때 실행한다
  - 새로운 조사 플랜이 열린다
- `스텝 아웃` : 조사하던 메소드를 호출한 메소드로 실행을 되돌린다
  - 이전 조사 플랜으로 돌아가고 싶을 때 실행한다
  - 조사 플랜이 닫힌다
- 코드 작동 방식을 알고 싶다면, 일단 스텝 오버로 시작하는 게 좋다
- 스텝 아웃하면 시간을 아낄 수 있다. 
  - 코드라인에서 스텝 인투해서 새로운 조사 플랜으로 들어가면 일단 그 코드를 읽어보고, 어떤 코드인지 파악이 되면 다시 스텝 아웃하여 원래 위치로 되돌아가라

## 2.3. 디버거로도 충분하지 않다면
- 디버거를 (또는 디버거만) 사용하는 것이 옳은 접근 방식이 아닌 케이스는?
  - 코드의 어느 부분이 아웃풋을 내는지 모르는 채 아웃풋 문제를 조사할 때
    - 디버깅에 착수하려면 먼저 코드에서 아웃풋을 잘못 생성한 부분을 찾아야 한다.
    - 문제를 일으킨 부위를 디버거로 찾기 어려운 경우, `앱 프로파일링`이나 `스터빙` 등을 사용한다
  - **성능** 문제를 조사할 때
    - `프로파일링`이나 `로깅` 기법을 적용하면 도움이 된다
    - 앱이 완전히 멈춘 경우 `스레드 덤프`를 수집해 분석하는 것이 가장 빠른 길이다
  - 앱 전체가 실패한 크래시를 조사할 때
    - 이 경우에는 디버거를 사용할 수 없다
    - `감사 로그`를 활용하거나 `스레드 또는 힙 덤프`를 수집해야 한다
  - 멀티스레드 구현체를 조사할 때
- **디버거 사용 시 가장 중요한 전제 조건 : 실행을 어디서 멈춰야 할 지 아는 것**

## 요약
- 코드 조사를 신속하게 끝내는 비결 중 하나는, 가능한 한 조사 플랜을 적게 여는 것이다
- 디버거를 이용하면 코드를 읽는 데 수반되는 인지적 부하를 줄이는 데 도움이 된다
- 어떤 라인에 스텝 인투한 다음에는 해당 코드를 읽고 이해하려고 노력하라.<br>로직을 이해했다면 스텝 아웃해서 이전 조사 플랜으로 돌아가라.<br>그래도 잘 모르겠다면 이해가 안되는 첫번째 커맨드를 찾아 브레이크 포인트를 직고 거기서부터 다시 디버깅을 시작하라